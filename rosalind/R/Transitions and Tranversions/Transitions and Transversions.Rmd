---
title: "Transitions and Transversions"
author: "Dominic Pearce"
date: "13 May 2016"
output: html_document
---

```{r}
library(magrittr)
```


```{r}
seq1.base <- "ATTGTGCACGACCCGGAACTGCTGCAAGGGTTATATCCCTGTCCCAACGGTGAAAACACAGCACAAATTAATGCAACACCATCGGGATAAGATCCACAGGCTAAACCATGGGAAGTGATTCAGCGGCCCGACTCATCATCGTAGGGGCGTTCATTGTCCCCCCCTCGAGCAGTAAACTATTAGCGGTAGTGGTCACGGACGAACGAAGATTCTAGTGTCGCCCTCCCACCCGTTAATGGGTGTCTGACAACCGTATTTTTTTTAGGCTACATTCTAACGGAATGGGTGATTTTCGACCGCGCCAGTTTGTGGTCACCTCAGCATCCGCTAGTAACAGGATTGGGGTCGGAAATAAGATGCTTCCACGGGCTTGATGCTCGTTGTCACTATCGAGTTTTGCTGAGCTGGAAGGTACAGAATCCACCAACTTTTAAGTTTACATAGATACGAGCCTTCTACCGTGCCGGCCAAGTTGCGTCTGTATTAGGCTAACCATGCCACGTCGGACAGTTGGGCGGATAATGCAAGGCCACTCAAGCTAAGAACCTCAAAGATGGTTTAGCAGTGGATTCGGCCCACAGTAGCCGATCACTGTCAAAATACTGCATGAGCGTAGGATCCAACGGTCTTTACTCTCATTTGTCATCAGCAACGTCTGAGCTAGGTAACTCATAACACAGTTAGAGATTCTCGCACCAGTTGATGCAAAATACACCCCCCGCACCAGAACAGGGGCTGGCACAAGTCAACAGCTTTCACTGGCGCCCTGTCAGGACATACGTTGCACCCTCGGGAGTATCAATGTTGTCCCG"

seq2.base <- "CTTGCGCTCAACCTGAAGCTGCTTTAAGGCGTATGCCTCTGCTTCGATAGTGAAAGCACTGCCCGAATTAATTCAACGCCATGGGGATAAACGGCACGGGCTCAATCACGGGAATTATTCCTGTAGCCCGAGCCGTTATCGTAAGAGTGTTCATTGTCCCCACTTCGAGCGCCAAACTGTTGGTGGCACTAGCCACGGGAGAGCCAAGATTCTAGTGTTGCCCTCCTGCTGGTTAGGGGGTGTCTGACAATTGTCGTTTCCTTAGGTCACATTCTAGCGGAGAGGGTGAACTCCAGTCGCGCCAATTTGTGCTCACCTTAGCACTCGCGAATATCGGGATTGGTGTCGGAGATAGGATGCTTCCGCAGGCCTGCTGCTCATAGTTACTGCCGGGCCCTCCTGAGCCGGGAAGTACAGACCCCATCAATTCTTAAACCTACATAGGTACTAGCCTTCCCCTGTGCCGGTCAGATTGCAATCGTATTCAACTAATCATGGCACGCCTCATAGTAGGGGCAACACTGCGAGGTCTCTTAAGGTAGGAACCTCTAGGATGGTGTAGCAGTGGATACGACCCGCATTCAGCAATTGCCGTCGGAGTACCGCATGAGCATCGGACTCAATGGTTTTTATTCCCGTTTCTCATTAGGGACGTCTGAGCTAAACGACTCATGACAAAAGCAGGGGTTCTAGCACCAGTTGATACAACGATCTCTCCCCGTACCGGACCGGGAGCTGGGATAACCTAATAGCTTTCATTAGCGCTTTATCAGGACATACGCTCTCCCTTCCGGAGGGGTCACGACGCCCTT"
```

```{r}
seq1 <- seq1.base %>% strsplit(split = "") %>% .[[1]]
seq2 <- seq2.base %>% strsplit(split = "") %>% .[[1]]

diff1 <- seq1[which(seq1 != seq2)]
diff2 <- seq2[which(seq1 != seq2)]

conversions <- lapply(1:length(diff1), function(x) paste0(diff1[x], diff2[x]))

conversions[1:6]

types <- lapply(conversions, function(x) 
  ifelse(x == "AG" | x == "GA" | x == "CT" | x == "TC", "ition", 
         ifelse(x == "AC" | x == "CA" | x == "GT" | x == "TG" | x == "AT" | x == "TA" | x == "CG" | x == "GC", "version", "oops"))) %>% 
  unlist() %>% 
  table()

types
options(digits = 22)
types[[1]] / types[[2]]
```

